var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(e,t){var r=function(e){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(!t)throw new Error("Joomla API is not properly initiated");if(!e.getAttribute("data-uri"))throw new Error("No valid url for validation");return e}return _inherits(r,HTMLElement),_createClass(r,[{key:"connectedCallback",value:function(){var e=[].slice.call(document.querySelectorAll("[data-onchange-task]"));e&&e.forEach(function(e){e.addEventListener("change",function(e){e.preventDefault(),"permissions.apply"==e.target.getAttribute("data-onchange-task")&&sendPermissions.call(e.target,e)})})}},{key:"sendPermissions",value:function(e){var r=e.target,n=document.getElementById("icon_"+this.id);n.removeAttribute("class"),n.setAttribute("class","fa fa-spinner fa-spin");var o="not",a=getUrlParam("component"),s=getUrlParam("extension"),i=getUrlParam("option"),l=getUrlParam("view"),c=a,u=this.value,f="";document.getElementById("jform_context")&&(f=(f=document.getElementById("jform_context").value).split(".")[0]),"com_config"==i&&0==a&&0==s?o="root.1":0==s&&"component"==l?o=a:f?(o="group"==l?f+".fieldgroup."+getUrlParam("id"):f+".field."+getUrlParam("id"),c=document.getElementById("jform_title").value):0!=s&&0!=l?(o=s+"."+l+"."+getUrlParam("id"),c=document.getElementById("jform_title").value):0==s&&0!=l&&(o=i+"."+l+"."+getUrlParam("id"),c=document.getElementById("jform_title").value);var m=this.id.replace("jform_rules_",""),p=m.lastIndexOf("_"),d={comp:o,action:m.substring(0,p),rule:m.substring(p+1),value:u,title:c};t.removeMessages(),t.request({url:document.getElementById("permissions-sliders").getAttribute("data-uri"),method:"POST",data:JSON.stringify(d),perform:!0,headers:{"Content-Type":"application/json"},onSuccess:function(e,o){try{e=JSON.parse(e)}catch(e){console.log(e)}if(n.removeAttribute("class"),e.data&&!0===e.data.result){n.setAttribute("class","fa fa-check");var a=r.parentNode.parentNode.nextElementSibling.querySelector("span");a.removeAttribute("class"),a.setAttribute("class",e.data.class),a.innerHTML=e.data.text}"object"===_typeof(e.messages)&&null!==e.messages&&(t.renderMessages(e.messages),e.data&&!0===e.data.result?n.setAttribute("class","fa fa-check"):n.setAttribute("class","fa fa-times"))},onError:function(e){n.removeAttribute("style"),t.renderMessages(t.ajaxErrorsMessages(jqXHR,textStatus,error)),n.setAttribute("class","fa fa-times")}})}},{key:"getUrlParam",value:function(e){for(var t=window.location.search.substring(1).split("&"),r=0;r<t.length;r+=1){var n=t[r].split("=");if(n[0]==e)return n[1]}return!1}}]),r}();e.define("joomla-field-permissions",r)}(customElements,Joomla);